<!DOCTYPE html>
<html class="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>OMI - The Big Picture</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico"/>
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon.png"/>
    <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png"/>
    <link href="/static/css/output.css" rel="stylesheet"/>
    <style>
        /* Contact panel slide animation */
        .contact-panel {
            transform: translateX(100%);
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .contact-panel.open {
            transform: translateX(0);
        }
        
        /* Overlay fade animation */
        .contact-overlay {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .contact-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }
        
        /* Gold accent for contact form */
        .gold-accent {
            color: #B4941E;
        }
        .gold-bg {
            background-color: #B4941E;
        }
        .gold-border {
            border-color: #B4941E;
        }
        .gold-ring:focus {
            --tw-ring-color: #B4941E;
            border-color: #B4941E;
        }
        .gold-glow:hover {
            box-shadow: 0 0 20px rgba(180, 148, 30, 0.3);
        }
        
        /* Glass panel for form sections */
        .glass-form {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Custom scrollbar for contact panel */
        .contact-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .contact-scroll::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }
        .contact-scroll::-webkit-scrollbar-thumb {
            background: rgba(180, 148, 30, 0.5);
            border-radius: 3px;
        }
        .contact-scroll::-webkit-scrollbar-thumb:hover {
            background: rgba(180, 148, 30, 0.7);
        }
        
        /* Storytelling section styles */
        .storytelling-gold {
            color: #B4941E;
        }
        .storytelling-gold-bg {
            background-color: #B4941E;
        }
        .icon-halo {
            background: radial-gradient(circle, rgba(244, 237, 225, 0.8) 0%, rgba(255, 255, 255, 0) 70%);
        }
        .step-node {
            background: white;
            border: 1px solid rgba(180, 148, 30, 0.2);
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
        }
        .group:hover .step-node {
            border-color: rgba(180, 148, 30, 0.8);
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 12px 30px rgba(180, 148, 30, 0.15);
        }
        .timeline-line {
            background: linear-gradient(90deg, transparent 0%, #B4941E 10%, #B4941E 90%, transparent 100%);
            height: 3px !important;
        }
        .icon-3d {
            filter: drop-shadow(0 4px 8px rgba(180, 148, 30, 0.4));
            background: linear-gradient(135deg, #D4AF37 0%, #B4941E 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-variation-settings: 'FILL' 1, 'wght' 600, 'GRAD' 0, 'opsz' 48;
        }
        
        /* Smooth scroll */
        html {
            scroll-behavior: smooth;
        }
        
        /* Hero Main Logo Animation */
        .hero-main-logo {
            position: relative;
            display: inline-block;
            animation: heroMainFloat 6s ease-in-out infinite;
            filter: drop-shadow(0 0 30px rgba(0, 0, 0, 0.6));
        }
        
        .hero-main-logo img {
            width: auto;
            height: 140px;
            position: relative;
            z-index: 1;
        }
        
        @media (min-width: 768px) {
            .hero-main-logo img {
                height: 200px;
            }
        }
        
        /* Floating animation */
        @keyframes heroMainFloat {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
                filter: drop-shadow(0 0 30px rgba(0, 0, 0, 0.6));
            }
            25% {
                transform: translateY(-8px) rotate(0.5deg);
                filter: drop-shadow(0 0 40px rgba(0, 0, 0, 0.7));
            }
            50% {
                transform: translateY(-4px) rotate(0deg);
                filter: drop-shadow(0 0 50px rgba(0, 0, 0, 0.8));
            }
            75% {
                transform: translateY(-10px) rotate(-0.5deg);
                filter: drop-shadow(0 0 35px rgba(0, 0, 0, 0.65));
            }
        }
        
        /* Pulsing glow effect */
        .hero-main-logo::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 120%;
            height: 120%;
            transform: translate(-50%, -50%);
            background: radial-gradient(
                ellipse at center,
                rgba(0, 0, 0, 0.3) 0%,
                rgba(0, 0, 0, 0.15) 30%,
                transparent 60%
            );
            animation: heroGlowPulse 3s ease-in-out infinite;
            z-index: 0;
            pointer-events: none;
            border-radius: 50%;
        }
        
        @keyframes heroGlowPulse {
            0%, 100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.6;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }
        }
        
        /* ===== Hero Animation Styles ===== */
        #hero-canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5;
            pointer-events: none;
        }
        
        #hero-canvas-container canvas {
            position: absolute;
            top: 0;
            right: 0;
            left: auto;
            width: 60%;
            height: 100%;
        }

        /* Logo container for final animation (right-aligned) */
        #hero-logo-container {
            position: absolute;
            top: 50%;
            right: 20%;
            transform: translate(50%, -50%) scale(0);
            z-index: 6;
            opacity: 0;
            transition: opacity 1s ease;
            pointer-events: none;
        }

        #hero-logo-container.visible {
            opacity: 1;
            animation: heroLogoFloat 8s ease-in-out infinite, heroLogoScale 2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        #hero-logo-container.grow {
            animation: heroLogoFloat 8s ease-in-out infinite, heroLogoGrow 3s ease-in-out forwards;
        }

        @keyframes heroLogoFloat {
            0%, 100% {
                transform: translate(50%, -50%) rotateY(0deg) rotateX(0deg);
            }
            25% {
                transform: translate(50%, -48%) rotateY(5deg) rotateX(2deg);
            }
            50% {
                transform: translate(50%, -50%) rotateY(0deg) rotateX(0deg);
            }
            75% {
                transform: translate(50%, -52%) rotateY(-5deg) rotateX(-2deg);
            }
        }

        @keyframes heroLogoScale {
            0% {
                transform: translate(50%, -50%) scale(0) rotateY(0deg);
            }
            100% {
                transform: translate(50%, -50%) scale(1) rotateY(0deg);
            }
        }

        @keyframes heroLogoGrow {
            0% {
                transform: translate(50%, -50%) scale(1) rotateY(0deg);
            }
            100% {
                transform: translate(50%, -50%) scale(1.3) rotateY(10deg);
            }
        }

        #hero-logo-container img {
            max-width: 300px;
            height: auto;
            filter: drop-shadow(0 0 30px rgba(201, 162, 39, 0.5));
            animation: heroLogoGlow 3s ease-in-out infinite alternate;
        }

        @keyframes heroLogoGlow {
            0% {
                filter: drop-shadow(0 0 20px rgba(201, 162, 39, 0.4));
            }
            100% {
                filter: drop-shadow(0 0 40px rgba(244, 214, 117, 0.7));
            }
        }

        /* Trees logo - positioned above particles (right-aligned) */
        #hero-trees-logo {
            position: absolute;
            top: 120px;
            right: 20%;
            transform: translateX(50%);
            z-index: 7;
            opacity: 0;
            transition: opacity 1s ease;
            pointer-events: none;
        }

        #hero-trees-logo.visible {
            opacity: 1;
        }

        #hero-trees-logo .logo-wrapper {
            position: relative;
            animation: heroLogoOscillate 2s ease-in-out infinite;
        }

        #hero-trees-logo img {
            max-width: 120px;
            height: auto;
            filter: drop-shadow(0 0 25px rgba(201, 162, 39, 0.6));
            animation: heroLogoShine 3s ease-in-out infinite;
        }

        @keyframes heroLogoOscillate {
            0%, 100% {
                transform: scale(0.9);
            }
            50% {
                transform: scale(1.1);
            }
        }

        @keyframes heroLogoShine {
            0%, 100% {
                filter: drop-shadow(0 0 20px rgba(201, 162, 39, 0.5)) brightness(1);
            }
            25% {
                filter: drop-shadow(0 0 35px rgba(244, 214, 117, 0.8)) brightness(1.2);
            }
            50% {
                filter: drop-shadow(0 0 25px rgba(201, 162, 39, 0.6)) brightness(1);
            }
            75% {
                filter: drop-shadow(0 0 40px rgba(255, 215, 0, 0.9)) brightness(1.3);
            }
        }

        /* Particle burst container */
        .hero-particle-burst {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        /* Firework sparkle particles - gold */
        .hero-sparkle {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #ffd700;
            opacity: 0;
        }

        .hero-sparkle::before,
        .hero-sparkle::after {
            content: '';
            position: absolute;
            width: 3px;
            height: 3px;
            border-radius: 50%;
            background: #f4d675;
        }

        .hero-sparkle::before {
            top: -8px;
            left: 0;
            opacity: 0.7;
        }

        .hero-sparkle::after {
            top: -16px;
            left: 1px;
            width: 2px;
            height: 2px;
            opacity: 0.4;
        }

        #hero-trees-logo.visible .hero-sparkle {
            animation: heroFireworkBurst 1.8s ease-out infinite;
        }

        .hero-sparkle:nth-child(1) { animation-delay: 0s; }
        .hero-sparkle:nth-child(2) { animation-delay: 0.1s; }
        .hero-sparkle:nth-child(3) { animation-delay: 0.2s; }
        .hero-sparkle:nth-child(4) { animation-delay: 0.3s; }
        .hero-sparkle:nth-child(5) { animation-delay: 0.4s; }
        .hero-sparkle:nth-child(6) { animation-delay: 0.5s; }
        .hero-sparkle:nth-child(7) { animation-delay: 0.9s; }
        .hero-sparkle:nth-child(8) { animation-delay: 1.0s; }
        .hero-sparkle:nth-child(9) { animation-delay: 1.1s; }
        .hero-sparkle:nth-child(10) { animation-delay: 1.2s; }
        .hero-sparkle:nth-child(11) { animation-delay: 1.3s; }
        .hero-sparkle:nth-child(12) { animation-delay: 1.4s; }

        @keyframes heroFireworkBurst {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1) rotate(var(--angle));
                box-shadow: 
                    0 0 8px 4px rgba(255, 215, 0, 1),
                    0 0 20px 8px rgba(255, 215, 0, 0.6),
                    0 0 40px 15px rgba(244, 214, 117, 0.3);
            }
            30% {
                opacity: 1;
                box-shadow: 
                    0 0 12px 6px rgba(255, 215, 0, 0.9),
                    0 0 30px 12px rgba(255, 165, 0, 0.5),
                    0 0 50px 20px rgba(201, 162, 39, 0.2);
            }
            60% {
                opacity: 0.7;
                box-shadow: 
                    0 0 6px 3px rgba(255, 215, 0, 0.6),
                    0 0 15px 6px rgba(255, 165, 0, 0.3);
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0.2) rotate(var(--angle));
                box-shadow: 0 0 4px 2px rgba(201, 162, 39, 0.2);
            }
        }

        .hero-sparkle:nth-child(1)  { --tx: 0px;    --ty: -120px; --angle: 0deg; }
        .hero-sparkle:nth-child(2)  { --tx: 85px;   --ty: -85px;  --angle: 45deg; }
        .hero-sparkle:nth-child(3)  { --tx: 120px;  --ty: 0px;    --angle: 90deg; }
        .hero-sparkle:nth-child(4)  { --tx: 85px;   --ty: 85px;   --angle: 135deg; }
        .hero-sparkle:nth-child(5)  { --tx: 0px;    --ty: 120px;  --angle: 180deg; }
        .hero-sparkle:nth-child(6)  { --tx: -85px;  --ty: 85px;   --angle: 225deg; }
        .hero-sparkle:nth-child(7)  { --tx: -120px; --ty: 0px;    --angle: 270deg; }
        .hero-sparkle:nth-child(8)  { --tx: -85px;  --ty: -85px;  --angle: 315deg; }
        .hero-sparkle:nth-child(9)  { --tx: 60px;   --ty: -100px; --angle: 30deg; }
        .hero-sparkle:nth-child(10) { --tx: 100px;  --ty: 60px;   --angle: 60deg; }
        .hero-sparkle:nth-child(11) { --tx: -60px;  --ty: 100px;  --angle: 210deg; }
        .hero-sparkle:nth-child(12) { --tx: -100px; --ty: -60px;  --angle: 240deg; }

        /* Stage text overlay (center-aligned with animation) */
        .hero-stage-text {
            position: absolute;
            bottom: 120px;
            right: 30%;
            transform: translateX(50%);
            color: #c9a227;
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
            opacity: 0;
            transition: opacity 0.8s ease;
            z-index: 8;
            text-shadow: 0 0 30px rgba(201, 162, 39, 0.8), 0 0 60px rgba(201, 162, 39, 0.4);
            letter-spacing: 3px;
            pointer-events: none;
        }

        .hero-stage-text.visible {
            opacity: 1;
        }

        .hero-stage-text .step-number {
            display: none;
        }

        .hero-stage-text .step-title {
            display: block;
            font-size: 2.5rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 6px;
            background: linear-gradient(135deg, #c9a227, #f4d675, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            filter: drop-shadow(0 0 20px rgba(201, 162, 39, 0.5));
        }

        .hero-stage-text .step-desc {
            display: block;
            font-size: 1.1rem;
            margin-top: 15px;
            max-width: 500px;
            opacity: 0.9;
            font-weight: 500;
            letter-spacing: 2px;
            color: #f4d675;
            text-shadow: 0 0 15px rgba(201, 162, 39, 0.5);
        }

        /* Intro text for trees (center-aligned with animation) */
        .hero-intro-text {
            position: absolute;
            bottom: 120px;
            right: 30%;
            transform: translateX(50%);
            color: #c9a227;
            font-size: 2rem;
            text-align: center;
            opacity: 0;
            transition: opacity 1s ease;
            z-index: 8;
            pointer-events: none;
        }

        .hero-intro-text.visible {
            opacity: 1;
        }

        .hero-intro-text .main {
            display: block;
            font-size: 3rem;
            font-weight: 800;
            letter-spacing: 8px;
            text-transform: uppercase;
            background: linear-gradient(135deg, #c9a227, #f4d675, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 20px rgba(201, 162, 39, 0.5));
        }

        .hero-intro-text .sub {
            display: block;
            font-size: 1.3rem;
            font-weight: 500;
            opacity: 0.95;
            letter-spacing: 4px;
            color: #f4d675;
            text-shadow: 0 0 20px rgba(201, 162, 39, 0.6);
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-[#111813] dark:text-white transition-colors duration-300">
    <!-- Contact Overlay -->
    <div id="contactOverlay" class="contact-overlay fixed inset-0 bg-black/60 z-[60]" onclick="closeContactPanel()"></div>
    
    <!-- Contact Slide-in Panel -->
    <div id="contactPanel" class="contact-panel fixed top-0 right-0 h-full w-full md:w-[600px] lg:w-[700px] bg-[#0a0c0b] z-[70] overflow-y-auto contact-scroll">
        <!-- Panel Header -->
        <div class="sticky top-0 z-10 flex items-center justify-between px-8 py-6 border-b border-white/10 bg-[#0a0c0b]/95 backdrop-blur-md">
            <div class="flex items-center gap-3">
                <div class="gold-accent">
                    <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                        <path d="M44 11.2727C44 14.0109 39.8386 16.3957 33.69 17.6364C39.8386 18.877 44 21.2618 44 24C44 26.7382 39.8386 29.123 33.69 30.3636C39.8386 31.6043 44 33.9891 44 36.7273C44 40.7439 35.0457 44 24 44C12.9543 44 4 40.7439 4 36.7273C4 33.9891 8.16144 31.6043 14.31 30.3636C8.16144 29.123 4 26.7382 4 24C4 21.2618 8.16144 18.877 14.31 17.6364C8.16144 16.3957 4 14.0109 4 11.2727C4 7.25611 12.9543 4 24 4C35.0457 4 44 7.25611 44 11.2727Z"></path>
                    </svg>
                </div>
                <h2 class="text-white text-xl font-extrabold tracking-tighter">Project Submission</h2>
            </div>
            <button onclick="closeContactPanel()" class="w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center hover:bg-white/10 transition-all text-white/60 hover:text-white">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        
        <!-- Panel Content -->
        <div class="px-8 py-8">
            <!-- Intro -->
            <div class="mb-10">
                <p class="text-white/60 text-base leading-relaxed">Share your cinematic vision with OMI. We are looking for stories that inspire, heal, and connect humanity with the big picture.</p>
                <div class="h-1 w-16 gold-bg mt-6"></div>
            </div>
            
            <!-- Form -->
            <form id="projectForm" class="space-y-8">
                <!-- Core Narrative Section -->
                <section class="glass-form p-6 rounded-2xl">
                    <h3 class="text-lg font-bold mb-5 flex items-center gap-2 text-white">
                        <span class="material-symbols-outlined gold-accent">auto_stories</span>
                        Core Narrative
                    </h3>
                    <div class="space-y-5">
                        <div>
                            <label for="title" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Project Title</label>
                            <input class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" id="title" name="title" placeholder="The name of your vision" type="text"/>
                        </div>
                        <div>
                            <label for="logline" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Logline</label>
                            <textarea class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2 resize-none" id="logline" name="logline" placeholder="One-sentence hook..." rows="2"></textarea>
                        </div>
                        <div>
                            <label for="synopsis" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Synopsis</label>
                            <textarea class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2 resize-none" id="synopsis" name="synopsis" placeholder="Detailed story summary..." rows="4"></textarea>
                        </div>
                        <div>
                            <label for="treatment" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Treatment URL</label>
                            <input class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" id="treatment" name="treatment" placeholder="Link to full treatment (PDF/Cloud)" type="url"/>
                        </div>
                    </div>
                </section>
                
                <!-- Visuals & Audio Section -->
                <section class="glass-form p-6 rounded-2xl">
                    <h3 class="text-lg font-bold mb-5 flex items-center gap-2 text-white">
                        <span class="material-symbols-outlined gold-accent">palette</span>
                        Visuals & Audio
                    </h3>
                    <div class="space-y-5">
                        <div>
                            <label for="moodboard" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Moodboard URL</label>
                            <input class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" id="moodboard" name="moodboard" placeholder="Pinterest, Behance, or PDF link" type="url"/>
                        </div>
                        <div>
                            <label for="soundtracks" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Soundtrack Inspiration</label>
                            <textarea class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2 resize-none" id="soundtracks" name="soundtracks" placeholder="Spotify playlist or descriptive audio style..." rows="2"></textarea>
                        </div>
                    </div>
                </section>
                
                <!-- Talent & Logistics Section -->
                <section class="glass-form p-6 rounded-2xl">
                    <h3 class="text-lg font-bold mb-5 flex items-center gap-2 text-white">
                        <span class="material-symbols-outlined gold-accent">person_pin_circle</span>
                        Talent & Logistics
                    </h3>
                    <div class="space-y-5">
                        <div>
                            <label for="writer-bio" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Writer Bio</label>
                            <textarea class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2 resize-none" id="writer-bio" name="writer_bio" placeholder="Your journey as a storyteller..." rows="3"></textarea>
                        </div>
                        <div>
                            <label class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Actor Recommendations (6 Slots)</label>
                            <div class="grid grid-cols-2 gap-3">
                                <input class="w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" name="actor_1" placeholder="Actor 1" type="text"/>
                                <input class="w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" name="actor_2" placeholder="Actor 2" type="text"/>
                                <input class="w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" name="actor_3" placeholder="Actor 3" type="text"/>
                                <input class="w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" name="actor_4" placeholder="Actor 4" type="text"/>
                                <input class="w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" name="actor_5" placeholder="Actor 5" type="text"/>
                                <input class="w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" name="actor_6" placeholder="Actor 6" type="text"/>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="budget" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Estimated Budget ($)</label>
                                <input class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" id="budget" name="budget" placeholder="0.00" type="number"/>
                            </div>
                            <div>
                                <label for="languages" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Primary Languages</label>
                                <input class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2" id="languages" name="languages" placeholder="English, French, etc." type="text"/>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Credentials Section -->
                <section class="glass-form p-6 rounded-2xl">
                    <h3 class="text-lg font-bold mb-5 flex items-center gap-2 text-white">
                        <span class="material-symbols-outlined gold-accent">history_edu</span>
                        Credentials
                    </h3>
                    <div class="space-y-5">
                        <div>
                            <label for="previous-works" class="block text-xs font-semibold gold-accent uppercase tracking-widest mb-2">Link to Previous Works</label>
                            <textarea class="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-white/30 gold-ring focus:outline-none focus:ring-2 resize-none" id="previous-works" name="previous_works" placeholder="Showreel or portfolio links..." rows="2"></textarea>
                        </div>
                        <div class="pt-4 border-t border-white/10">
                            <label class="flex items-start gap-3 cursor-pointer group">
                                <input class="mt-1 w-4 h-4 rounded border-white/20 text-[#B4941E] focus:ring-[#B4941E] bg-transparent" name="terms" type="checkbox"/>
                                <span class="text-xs text-white/50 group-hover:text-white/80 transition-colors leading-relaxed">
                                    I agree to the OMI Terms & Conditions. I confirm that this vision is my original work and aligns with the mission of global healing and sustainability.
                                </span>
                            </label>
                        </div>
                    </div>
                </section>
                
                <!-- Submit Section -->
                <div class="flex flex-col sm:flex-row items-center justify-between gap-6 pt-6 border-t border-white/10">
                    <div class="flex items-center gap-3 text-white/40">
                        <span class="material-symbols-outlined text-lg">verified_user</span>
                        <p class="text-xs">Your data is encrypted and protected.</p>
                    </div>
                    <button class="w-full sm:w-auto flex items-center justify-center gap-3 gold-bg text-black px-10 py-4 rounded-xl font-bold text-base hover:scale-105 transition-all gold-glow" type="submit">
                        <span>Submit Project</span>
                        <span class="material-symbols-outlined">send</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Cinematic Hero Wrapper -->
    <div class="relative min-h-screen w-full flex flex-col overflow-hidden">
        <!-- Background Image with Overlay -->
        <div class="absolute inset-0 z-0">
            <div class="absolute inset-0 bg-black/30 z-10"></div>
            <div class="absolute inset-0 bg-gradient-to-r from-black/60 via-black/20 to-transparent z-10"></div>
            <img alt="Serene landscape with mountains and mist" class="w-full h-full object-cover" src="/static/images/hero-landscape.jpg"/>
        </div>
        
        <!-- Three.js Particle Animation Canvas -->
        <div id="hero-canvas-container"></div>
        
        
        <!-- Intro Text -->
        <div class="hero-intro-text" id="heroIntroText">
            <span class="main">The Journey Begins</span>
            <span class="sub">Where stories take root and grow</span>
        </div>
        
        <!-- Stage Text for Steps -->
        <div class="hero-stage-text" id="heroStageText">
            <span class="step-number" id="heroStepNumber"></span>
            <span class="step-title" id="heroStepTitle"></span>
            <span class="step-desc" id="heroStepDesc"></span>
        </div>
        
        <!-- Top Navigation Bar -->
        <header class="relative z-50 flex items-center justify-between px-10 py-6 glass-nav border-b border-white/10">
            <nav class="hidden md:flex items-center gap-10">
                <a class="text-white/80 hover:text-primary transition-colors text-sm font-medium uppercase tracking-widest" href="#">About</a>
                <a class="text-white/80 hover:text-primary transition-colors text-sm font-medium uppercase tracking-widest" href="#storytelling">Storytelling</a>
                <a class="text-white/80 hover:text-primary transition-colors text-sm font-medium uppercase tracking-widest" href="#">Wellness</a>
                <a class="text-white/80 hover:text-primary transition-colors text-sm font-medium uppercase tracking-widest" href="#">Sustainability</a>
            </nav>
            <div class="flex items-center gap-4">
                <button onclick="openContactPanel()" class="bg-primary hover:bg-primary/90 text-[#112116] px-6 py-2 rounded-lg font-bold text-sm transition-all transform hover:scale-105">
                    Contact
                </button>
            </div>
        </header>
        <!-- Main Hero Content -->
        <main class="relative z-20 flex-1 flex flex-col justify-center px-10 md:px-24 max-w-7xl">
            <div class="max-w-2xl">
                <div class="hero-main-logo mb-6">
                    <img src="/static/images/omi-logo-transparent-latest.png" alt="OMI"/>
                </div>
                <h2 class="text-white/90 text-2xl md:text-4xl font-light tracking-wide mb-8">
                    A Vision Beyond Cinema.
                </h2>
                <div class="h-1 w-24 bg-primary mb-12"></div>
            </div>
        </main>
        <!-- Bottom Content Bar -->
        <section class="relative z-20 w-full px-10 md:px-24 pb-16">
            <div class="flex flex-col md:flex-row items-end justify-between gap-8">
                <div class="max-w-xl">
                    <p class="text-white/80 text-lg leading-relaxed font-light">
                        OMI is a creative hub dedicated to storytelling, wellness, and sustainability. Our mission is to inspire and heal through global collaboration, art, and nature. We see the world not just as it is, but as a canvas for collective healing.
                    </p>
                </div>
                <div class="flex flex-col items-center md:items-end gap-6">
                    <div class="flex items-center gap-2 text-white/40">
                        <span class="text-xs uppercase tracking-[0.3em]">Scroll for more</span>
                        <span class="material-symbols-outlined animate-bounce text-sm">expand_more</span>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <!-- Features Section -->
    <div class="bg-background-light dark:bg-background-dark py-24 px-10 md:px-40">
        <div class="max-w-[960px] mx-auto">
            <div class="flex flex-col gap-10 @container">
                <div class="flex flex-col gap-4">
                    <h1 class="text-[#111813] dark:text-white tracking-tight text-[32px] font-extrabold leading-tight @[480px]:text-5xl">
                        Our Pillars
                    </h1>
                    <p class="text-[#63886f] dark:text-white/60 text-lg font-normal leading-normal max-w-[720px]">
                        Everything we create is anchored in three core focuses that drive human connection and ecological harmony.
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Feature Card 1 -->
                    <div class="group flex flex-1 gap-5 rounded-xl border border-[#dce5df] dark:border-white/10 bg-white dark:bg-white/5 p-8 flex-col hover:border-primary transition-all duration-300">
                        <div class="text-primary group-hover:scale-110 transition-transform">
                            <span class="material-symbols-outlined !text-4xl">movie</span>
                        </div>
                        <div class="flex flex-col gap-2">
                            <h2 class="text-[#111813] dark:text-white text-xl font-bold">Storytelling</h2>
                            <p class="text-[#63886f] dark:text-white/60 text-base leading-relaxed">
                                Narratives that move the soul and challenge the conventional boundaries of digital media.
                            </p>
                        </div>
                    </div>
                    <!-- Feature Card 2 -->
                    <div class="group flex flex-1 gap-5 rounded-xl border border-[#dce5df] dark:border-white/10 bg-white dark:bg-white/5 p-8 flex-col hover:border-primary transition-all duration-300">
                        <div class="text-primary group-hover:scale-110 transition-transform">
                            <span class="material-symbols-outlined !text-4xl">spa</span>
                        </div>
                        <div class="flex flex-col gap-2">
                            <h2 class="text-[#111813] dark:text-white text-xl font-bold">Wellness</h2>
                            <p class="text-[#63886f] dark:text-white/60 text-base leading-relaxed">
                                Holistic practices and environments designed to nourish the mind and restore inner balance.
                            </p>
                        </div>
                    </div>
                    <!-- Feature Card 3 -->
                    <div class="group flex flex-1 gap-5 rounded-xl border border-[#dce5df] dark:border-white/10 bg-white dark:bg-white/5 p-8 flex-col hover:border-primary transition-all duration-300">
                        <div class="text-primary group-hover:scale-110 transition-transform">
                            <span class="material-symbols-outlined !text-4xl">eco</span>
                        </div>
                        <div class="flex flex-col gap-2">
                            <h2 class="text-[#111813] dark:text-white text-xl font-bold">Sustainability</h2>
                            <p class="text-[#63886f] dark:text-white/60 text-base leading-relaxed">
                                Building a greener future by integrating nature directly into our creative workflows.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Mission Text Section -->
    <div class="bg-background-light dark:bg-background-dark py-20 px-10 md:px-40">
        <div class="max-w-[720px] mx-auto text-center">
            <p class="text-[#111813] dark:text-white text-2xl font-light leading-relaxed">
                "We believe that the stories we tell today shape the reality we live in tomorrow. OMI exists to ensure that reality is one of connection, health, and respect for our planet."
            </p>
            <div class="mt-8 flex justify-center items-center gap-4">
                <div class="w-10 h-px bg-primary/40"></div>
                <span class="text-sm font-bold uppercase tracking-widest text-[#63886f]">The OMI Philosophy</span>
                <div class="w-10 h-px bg-primary/40"></div>
            </div>
        </div>
    </div>
    
    <!-- Storytelling Journey Section -->
    <section id="storytelling" class="bg-white dark:bg-[#0a0a0a] py-16 px-6">
        <!-- Section Header -->
        <div class="max-w-4xl mx-auto text-center pt-8 pb-12">
            <h3 class="storytelling-gold text-[11px] font-bold tracking-[0.5em] uppercase mb-6">The Path to Production</h3>
            <h1 class="text-[#2D2D2D] dark:text-white text-5xl md:text-[64px] font-bold tracking-tight mb-8 leading-[1.1]">
                The OMI <span class="italic font-light storytelling-gold">Storytelling</span> Journey
            </h1>
            <p class="text-[#3A3428] dark:text-white/70 text-base md:text-lg font-normal leading-relaxed max-w-2xl mx-auto opacity-90">
                A collaborative evolution designed for visionary narrative makers. We nurture stories that move the collective consciousness through a refined five-step process.
            </p>
        </div>
        
        <!-- Horizontal Timeline -->
        <div class="relative py-24 overflow-hidden">
            <div class="max-w-[1400px] mx-auto px-6 relative">
                <!-- Horizontal Timeline Line -->
                <div class="absolute top-[70px] left-[5%] right-[5%] h-[3px] timeline-line z-0 hidden md:block"></div>
                
                <!-- 5-Column Grid -->
                <div class="grid grid-cols-1 md:grid-cols-5 gap-8 relative z-10">
                    <!-- Step 1 -->
                    <div class="flex flex-col items-center text-center group">
                        <div class="relative mb-10">
                            <div class="absolute inset-0 scale-150 icon-halo -z-10 rounded-full"></div>
                            <div class="w-32 h-32 rounded-full step-node flex items-center justify-center relative">
                                <div class="absolute -top-1 -right-1 w-10 h-10 storytelling-gold-bg text-white text-xs font-bold rounded-full flex items-center justify-center border-4 border-white shadow-md">01</div>
                                <span class="material-symbols-outlined !text-5xl icon-3d">edit_note</span>
                            </div>
                        </div>
                        <h3 class="text-sm font-extrabold mb-4 uppercase tracking-wider text-[#2D2D2D] dark:text-white h-10 flex items-center px-4">Submit Profile & Project</h3>
                        <p class="text-[#3A3428] dark:text-white/60 text-[13px] leading-relaxed max-w-[220px] font-medium opacity-90">
                            Introduce your vision through our curated submission form. We review every proposal with a cinematic lens.
                        </p>
                    </div>
                    
                    <!-- Step 2 -->
                    <div class="flex flex-col items-center text-center group">
                        <div class="relative mb-10">
                            <div class="absolute inset-0 scale-150 icon-halo -z-10 rounded-full"></div>
                            <div class="w-32 h-32 rounded-full step-node flex items-center justify-center relative">
                                <div class="absolute -top-1 -right-1 w-10 h-10 storytelling-gold-bg text-white text-xs font-bold rounded-full flex items-center justify-center border-4 border-white shadow-md">02</div>
                                <span class="material-symbols-outlined !text-5xl icon-3d">graphic_eq</span>
                            </div>
                        </div>
                        <h3 class="text-sm font-extrabold mb-4 uppercase tracking-wider text-[#2D2D2D] dark:text-white h-10 flex items-center px-4">The Callback</h3>
                        <p class="text-[#3A3428] dark:text-white/60 text-[13px] leading-relaxed max-w-[220px] font-medium opacity-90">
                            If your script resonates with our core mission, we'll reach out to explore the narrative's soul and depth.
                        </p>
                    </div>
                    
                    <!-- Step 3 -->
                    <div class="flex flex-col items-center text-center group">
                        <div class="relative mb-10">
                            <div class="absolute inset-0 scale-150 icon-halo -z-10 rounded-full"></div>
                            <div class="w-32 h-32 rounded-full step-node flex items-center justify-center relative">
                                <div class="absolute -top-1 -right-1 w-10 h-10 storytelling-gold-bg text-white text-xs font-bold rounded-full flex items-center justify-center border-4 border-white shadow-md">03</div>
                                <span class="material-symbols-outlined !text-5xl icon-3d">center_focus_strong</span>
                            </div>
                        </div>
                        <h3 class="text-sm font-extrabold mb-4 uppercase tracking-wider text-[#2D2D2D] dark:text-white h-10 flex items-center px-4">In-Person Review</h3>
                        <p class="text-[#3A3428] dark:text-white/60 text-[13px] leading-relaxed max-w-[220px] font-medium opacity-90">
                            A personal creative session to evaluate artistic potential and align our shared storytelling values.
                        </p>
                    </div>
                    
                    <!-- Step 4 -->
                    <div class="flex flex-col items-center text-center group">
                        <div class="relative mb-10">
                            <div class="absolute inset-0 scale-150 icon-halo -z-10 rounded-full"></div>
                            <div class="w-32 h-32 rounded-full step-node flex items-center justify-center relative">
                                <div class="absolute -top-1 -right-1 w-10 h-10 storytelling-gold-bg text-white text-xs font-bold rounded-full flex items-center justify-center border-4 border-white shadow-md">04</div>
                                <span class="material-symbols-outlined !text-5xl icon-3d">settings_input_component</span>
                            </div>
                        </div>
                        <h3 class="text-sm font-extrabold mb-4 uppercase tracking-wider text-[#2D2D2D] dark:text-white h-10 flex items-center px-4">Producer Meeting</h3>
                        <p class="text-[#3A3428] dark:text-white/60 text-[13px] leading-relaxed max-w-[220px] font-medium opacity-90">
                            Concrete discussions on resources, terms, and the strategic roadmap from script to global screens.
                        </p>
                    </div>
                    
                    <!-- Step 5 -->
                    <div class="flex flex-col items-center text-center group">
                        <div class="relative mb-10">
                            <div class="absolute inset-0 scale-150 icon-halo -z-10 rounded-full"></div>
                            <div class="w-32 h-32 rounded-full step-node flex items-center justify-center relative">
                                <div class="absolute -top-1 -right-1 w-10 h-10 storytelling-gold-bg text-white text-xs font-bold rounded-full flex items-center justify-center border-4 border-white shadow-md">05</div>
                                <span class="material-symbols-outlined !text-5xl icon-3d">history_edu</span>
                            </div>
                        </div>
                        <h3 class="text-sm font-extrabold mb-4 uppercase tracking-wider text-[#2D2D2D] dark:text-white h-10 flex items-center px-4">Final Agreement</h3>
                        <p class="text-[#3A3428] dark:text-white/60 text-[13px] leading-relaxed max-w-[220px] font-medium opacity-90">
                            Partnership commences. We officially join forces to realize your project as part of the OMI ecosystem.
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Submit CTA Button -->
            <div class="mt-20 text-center">
                <button onclick="openContactPanel()" class="inline-flex items-center gap-4 storytelling-gold-bg text-white px-12 py-5 font-bold uppercase tracking-[0.3em] text-[11px] hover:translate-y-[-2px] hover:opacity-90 transition-all hover:shadow-[0_10px_40px_-10px_rgba(180,148,30,0.3)]">
                    Submit Your Vision
                    <span class="material-symbols-outlined !text-sm">north_east</span>
                </button>
            </div>
        </div>
        
        <!-- CTA Section -->
        <div class="py-24 px-6 bg-[#faf9f6] dark:bg-white/5 border-y border-black/5 dark:border-white/10">
            <div class="max-w-4xl mx-auto text-center">
                <div class="mb-10 inline-block">
                    <div class="opacity-60">
                        <img src="/static/images/omi-logo-transparent-graphic.png" alt="OMI" class="w-24 h-auto mx-auto" />
                    </div>
                </div>
                <h2 class="text-[#2D2D2D] dark:text-white text-4xl md:text-5xl font-bold mb-6 tracking-tight">Ready to Begin?</h2>
                <p class="text-[#3A3428] dark:text-white/60 text-lg font-normal mb-12 max-w-xl mx-auto leading-relaxed opacity-90">
                    Our submission window is open for narratives focused on sustainability, wellness, and transformative growth.
                </p>
                <button onclick="openContactPanel()" class="storytelling-gold-bg text-white px-14 py-6 text-[11px] font-bold uppercase tracking-[0.4em] hover:opacity-90 transition-all hover:shadow-[0_10px_40px_-10px_rgba(180,148,30,0.3)]">
                    Submit Your Vision
                </button>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer class="bg-background-light dark:bg-background-dark border-t border-[#dce5df] dark:border-white/10">
        <div class="max-w-[960px] mx-auto px-10 py-16 flex flex-col gap-10">
            <div class="flex flex-col md:flex-row justify-between items-center gap-8">
                <div class="flex items-center gap-3">
                    <img src="/static/images/omi-logo-transparent-graphic.png" alt="OMI" class="w-10 h-auto" />
                    <span class="font-extrabold text-xl tracking-tighter">OMI</span>
                </div>
                <div class="flex flex-wrap items-center justify-center gap-8">
                    <a class="text-[#63886f] dark:text-white/60 text-sm font-medium hover:text-primary transition-colors" href="#">Privacy Policy</a>
                    <a class="text-[#63886f] dark:text-white/60 text-sm font-medium hover:text-primary transition-colors" href="#">Terms of Service</a>
                    <a class="text-[#63886f] dark:text-white/60 text-sm font-medium hover:text-primary transition-colors" href="#">Press Kit</a>
                </div>
                <div class="flex gap-4">
                    <a class="w-10 h-10 rounded-full bg-white dark:bg-white/5 border border-[#dce5df] dark:border-white/10 flex items-center justify-center hover:bg-primary transition-all text-[#63886f] dark:text-white/60 hover:text-white" href="#">
                        <span class="material-symbols-outlined !text-xl">language</span>
                    </a>
                    <a class="w-10 h-10 rounded-full bg-white dark:bg-white/5 border border-[#dce5df] dark:border-white/10 flex items-center justify-center hover:bg-primary transition-all text-[#63886f] dark:text-white/60 hover:text-white" href="#">
                        <span class="material-symbols-outlined !text-xl">alternate_email</span>
                    </a>
                    <a class="w-10 h-10 rounded-full bg-white dark:bg-white/5 border border-[#dce5df] dark:border-white/10 flex items-center justify-center hover:bg-primary transition-all text-[#63886f] dark:text-white/60 hover:text-white" href="#">
                        <span class="material-symbols-outlined !text-xl">share</span>
                    </a>
                </div>
            </div>
            <p class="text-[#63886f] dark:text-white/40 text-sm text-center">
                 2024 OMI Hub. Consciously created for a better tomorrow.
            </p>
        </div>
    </footer>
    
    <!-- Three.js Import Map -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    
    <!-- Hero Particle Animation -->
    <script type="module">
        import * as THREE from 'three';

        // Configuration
        const PARTICLE_COUNT = 15000;
        const STAGE_DURATION = 8000; // 8 seconds per step for particles to fully form

        // OMI Storytelling Steps
        const STORYTELLING_STEPS = [
            {
                number: "STEP ONE",
                title: "Submit Profile & Project",
                desc: "Introduce your vision through our curated submission form",
                shape: "scroll"
            },
            {
                number: "STEP TWO", 
                title: "The Callback",
                desc: "We reach out to explore the narrative's soul and depth",
                shape: "spiral"
            },
            {
                number: "STEP THREE",
                title: "In-Person Review",
                desc: "A personal creative session to align storytelling values",
                shape: "circle"
            },
            {
                number: "STEP FOUR",
                title: "Producer Meeting",
                desc: "Strategic roadmap from script to global screens",
                shape: "film"
            },
            {
                number: "STEP FIVE",
                title: "Final Agreement",
                desc: "Partnership commences in the OMI ecosystem",
                shape: "imageLogo"
            }
        ];

        // Store logo image positions
        let logoImagePositions = null;
        // Store callback icon positions (incoming call SVG)
        let callbackImagePositions = null;

        // Gold color palette
        const GOLD_COLORS = [
            new THREE.Color(0xc9a227),
            new THREE.Color(0xf4d675),
            new THREE.Color(0xd4af37),
            new THREE.Color(0xffd700),
            new THREE.Color(0xb8860b),
            new THREE.Color(0xdaa520),
        ];

        let scene, camera, renderer, particles;
        let currentStage = 'trees';
        let targetPositions = [];
        let time = 0;
        let stageStartTime = 0;

        async function initHeroAnimation() {
            const container = document.getElementById('hero-canvas-container');
            if (!container) return;
            
            // Check for WebGL support with Chrome-compatible attributes
            const testCanvas = document.createElement('canvas');
            const contextAttributes = {
                alpha: true,
                antialias: false,
                depth: false,
                stencil: false,
                preserveDrawingBuffer: false,
                powerPreference: 'default',
                failIfMajorPerformanceCaveat: false
            };
            
            // Try WebGL2 first, then WebGL1
            let gl = testCanvas.getContext('webgl2', contextAttributes);
            if (!gl) {
                gl = testCanvas.getContext('webgl', contextAttributes) || 
                     testCanvas.getContext('experimental-webgl', contextAttributes);
            }
            
            if (!gl) {
                console.warn('WebGL not supported, hero animation disabled');
                hideAnimationElements();
                return;
            }
            
            try {
                scene = new THREE.Scene();
                
                camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.z = 100;

                // Create canvas element explicitly for better Chrome compatibility
                const canvas = document.createElement('canvas');
                container.appendChild(canvas);
                
                // Right-aligned: use 60% of viewport width
                const canvasWidth = Math.floor(window.innerWidth * 0.6);
                const canvasHeight = window.innerHeight;

                renderer = new THREE.WebGLRenderer({ 
                    canvas: canvas,
                    antialias: true, 
                    alpha: true,
                    powerPreference: 'default',
                    failIfMajorPerformanceCaveat: false,
                    preserveDrawingBuffer: false
                });
                
                renderer.setSize(canvasWidth, canvasHeight);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                renderer.setClearColor(0x000000, 0);
                
                // Update camera aspect ratio for narrower canvas
                camera.aspect = canvasWidth / canvasHeight;
                camera.updateProjectionMatrix();

                createParticles();
                setParticlePositions('trees');

                window.addEventListener('resize', onWindowResize);
                animate();

                // Pre-load logo image for final step
                loadLogoImage();
                // Pre-load callback icon for callback step
                loadCallbackImage();

                // Start with trees
                setTimeout(startExperience, 500);
            } catch (e) {
                console.warn('Failed to initialize hero animation:', e.message);
                hideAnimationElements();
            }
        }
        
        function hideAnimationElements() {
            const container = document.getElementById('hero-canvas-container');
            const introText = document.getElementById('heroIntroText');
            const stageText = document.getElementById('heroStageText');
            if (container) container.style.display = 'none';
            if (introText) introText.style.display = 'none';
            if (stageText) stageText.style.display = 'none';
        }

        function createParticles() {
            const geometry = new THREE.BufferGeometry();
            const positions = new Float32Array(PARTICLE_COUNT * 3);
            const colors = new Float32Array(PARTICLE_COUNT * 3);
            const sizes = new Float32Array(PARTICLE_COUNT);
            const alphas = new Float32Array(PARTICLE_COUNT);

            for (let i = 0; i < PARTICLE_COUNT; i++) {
                positions[i * 3] = 0;
                positions[i * 3 + 1] = 0;
                positions[i * 3 + 2] = 0;

                const color = GOLD_COLORS[Math.floor(Math.random() * GOLD_COLORS.length)];
                colors[i * 3] = color.r;
                colors[i * 3 + 1] = color.g;
                colors[i * 3 + 2] = color.b;

                sizes[i] = Math.random() * 2 + 0.5;
                alphas[i] = 0;
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            geometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));
            geometry.setAttribute('alpha', new THREE.BufferAttribute(alphas, 1));

            targetPositions = new Float32Array(PARTICLE_COUNT * 3);

            const material = new THREE.ShaderMaterial({
                uniforms: {
                    time: { value: 0 },
                    pixelRatio: { value: Math.min(window.devicePixelRatio, 2) }
                },
                vertexShader: `
                    attribute float size;
                    attribute vec3 color;
                    attribute float alpha;
                    varying vec3 vColor;
                    varying float vAlpha;
                    uniform float time;
                    uniform float pixelRatio;
                    
                    void main() {
                        vColor = color;
                        vAlpha = alpha;
                        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
                        gl_PointSize = size * pixelRatio * (180.0 / -mvPosition.z);
                        gl_Position = projectionMatrix * mvPosition;
                    }
                `,
                fragmentShader: `
                    varying vec3 vColor;
                    varying float vAlpha;
                    
                    void main() {
                        float dist = length(gl_PointCoord - vec2(0.5));
                        if (dist > 0.5) discard;
                        float glow = 1.0 - smoothstep(0.0, 0.5, dist);
                        gl_FragColor = vec4(vColor, glow * vAlpha);
                    }
                `,
                transparent: true,
                blending: THREE.AdditiveBlending,
                depthWrite: false
            });

            particles = new THREE.Points(geometry, material);
            scene.add(particles);
        }

        // ===== SHAPE GENERATORS =====

        function generateTreePositions() {
            const positions = new Float32Array(PARTICLE_COUNT * 3);
            const treeCount = 9;
            const particlesPerTree = Math.floor(PARTICLE_COUNT * 0.75 / treeCount);
            const groundParticles = PARTICLE_COUNT - particlesPerTree * treeCount;
            let idx = 0;

            for (let t = 0; t < treeCount; t++) {
                const treeX = (t - treeCount / 2) * 15 + (Math.random() - 0.5) * 5;
                const treeHeight = 30 + Math.random() * 20;
                const treeZ = (Math.random() - 0.5) * 25;

                for (let i = 0; i < particlesPerTree && idx < PARTICLE_COUNT; i++) {
                    const heightRatio = Math.random();
                    const y = -28 + heightRatio * treeHeight;

                    if (heightRatio < 0.3) {
                        const trunkRadius = 1.8 * (1 - heightRatio * 0.4);
                        const angle = Math.random() * Math.PI * 2;
                        positions[idx * 3] = treeX + Math.cos(angle) * trunkRadius * Math.random();
                        positions[idx * 3 + 1] = y;
                        positions[idx * 3 + 2] = treeZ + Math.sin(angle) * trunkRadius * Math.random();
                    } else {
                        const spread = (heightRatio - 0.3) * 14 * Math.sin(heightRatio * Math.PI * 0.8);
                        const angle = Math.random() * Math.PI * 2;
                        const dist = Math.random() * spread;
                        positions[idx * 3] = treeX + Math.cos(angle) * dist;
                        positions[idx * 3 + 1] = y + (Math.random() - 0.5) * 4;
                        positions[idx * 3 + 2] = treeZ + Math.sin(angle) * dist;
                    }
                    idx++;
                }
            }

            for (; idx < PARTICLE_COUNT; idx++) {
                positions[idx * 3] = (Math.random() - 0.5) * 140;
                positions[idx * 3 + 1] = -28 + Math.random() * 5;
                positions[idx * 3 + 2] = (Math.random() - 0.5) * 50;
            }

            return positions;
        }

        function generateScrollPositions() {
            // Document with arrow shape (Submit Profile icon)
            const positions = new Float32Array(PARTICLE_COUNT * 3);
            
            // Document dimensions
            const docWidth = 40;
            const docHeight = 50;
            const docX = -10; // Offset left to make room for arrow
            const foldSize = 12;
            const lineThickness = 2;
            
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                const t = Math.random();
                
                if (t < 0.25) {
                    // Document outline (left, bottom, partial top, partial right)
                    const edge = Math.random();
                    if (edge < 0.25) {
                        // Left edge
                        positions[i * 3] = docX - docWidth/2 + (Math.random() - 0.5) * lineThickness;
                        positions[i * 3 + 1] = (Math.random() - 0.5) * docHeight;
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 3;
                    } else if (edge < 0.5) {
                        // Bottom edge
                        positions[i * 3] = docX + (Math.random() - 0.5) * docWidth;
                        positions[i * 3 + 1] = -docHeight/2 + (Math.random() - 0.5) * lineThickness;
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 3;
                    } else if (edge < 0.75) {
                        // Top edge (shorter due to fold)
                        positions[i * 3] = docX - docWidth/4 + (Math.random() - 0.3) * (docWidth - foldSize);
                        positions[i * 3 + 1] = docHeight/2 + (Math.random() - 0.5) * lineThickness;
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 3;
                    } else {
                        // Right edge (shorter due to fold)
                        positions[i * 3] = docX + docWidth/2 + (Math.random() - 0.5) * lineThickness;
                        positions[i * 3 + 1] = (Math.random() - 0.6) * (docHeight - foldSize);
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 3;
                    }
                } else if (t < 0.35) {
                    // Folded corner (triangle)
                    const foldT = Math.random();
                    const cornerX = docX + docWidth/2;
                    const cornerY = docHeight/2;
                    
                    if (foldT < 0.4) {
                        // Diagonal fold line
                        const diagT = Math.random();
                        positions[i * 3] = cornerX - foldSize * diagT + (Math.random() - 0.5) * lineThickness;
                        positions[i * 3 + 1] = cornerY - foldSize * (1 - diagT) + (Math.random() - 0.5) * lineThickness;
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 3;
                    } else if (foldT < 0.7) {
                        // Horizontal part of fold
                        positions[i * 3] = cornerX - foldSize + Math.random() * foldSize;
                        positions[i * 3 + 1] = cornerY + (Math.random() - 0.5) * lineThickness;
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 3;
                    } else {
                        // Vertical part of fold
                        positions[i * 3] = cornerX + (Math.random() - 0.5) * lineThickness;
                        positions[i * 3 + 1] = cornerY - foldSize + Math.random() * foldSize;
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 3;
                    }
                } else if (t < 0.55) {
                    // Text lines inside document
                    const lineNum = Math.floor(Math.random() * 5);
                    const lineWidth = 25 - lineNum * 2; // Lines get slightly shorter
                    const lineY = 15 - lineNum * 10;
                    
                    positions[i * 3] = docX - 5 + (Math.random() - 0.3) * lineWidth;
                    positions[i * 3 + 1] = lineY + (Math.random() - 0.5) * lineThickness;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 2;
                } else if (t < 0.85) {
                    // Arrow pointing right
                    const arrowX = 25;
                    const arrowY = -15;
                    const arrowLength = 25;
                    const arrowHeadSize = 15;
                    
                    const arrowPart = Math.random();
                    if (arrowPart < 0.4) {
                        // Arrow shaft
                        positions[i * 3] = arrowX - arrowLength/2 + Math.random() * arrowLength;
                        positions[i * 3 + 1] = arrowY + (Math.random() - 0.5) * 6;
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 4;
                    } else if (arrowPart < 0.7) {
                        // Arrow head - top diagonal
                        const headT = Math.random();
                        positions[i * 3] = arrowX + arrowLength/2 - headT * arrowHeadSize + (Math.random() - 0.5) * 3;
                        positions[i * 3 + 1] = arrowY + headT * arrowHeadSize + (Math.random() - 0.5) * 3;
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 4;
                    } else {
                        // Arrow head - bottom diagonal
                        const headT = Math.random();
                        positions[i * 3] = arrowX + arrowLength/2 - headT * arrowHeadSize + (Math.random() - 0.5) * 3;
                        positions[i * 3 + 1] = arrowY - headT * arrowHeadSize + (Math.random() - 0.5) * 3;
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 4;
                    }
                } else {
                    // Ambient particles around the shape
                    const angle = Math.random() * Math.PI * 2;
                    const dist = 40 + Math.random() * 25;
                    positions[i * 3] = Math.cos(angle) * dist;
                    positions[i * 3 + 1] = Math.sin(angle) * dist * 0.7;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 15;
                }
            }

            return positions;
        }

        function generateSpiralPositions() {
            // Phone + callback arrow using sampled SVG pixels
            const positions = new Float32Array(PARTICLE_COUNT * 3);

            if (callbackImagePositions) {
                const totalPoints = callbackImagePositions.length / 3;
                for (let i = 0; i < PARTICLE_COUNT; i++) {
                    const baseIdx = Math.floor(Math.random() * totalPoints) * 3;
                    positions[i * 3] = callbackImagePositions[baseIdx] + (Math.random() - 0.5) * 1.2;
                    positions[i * 3 + 1] = callbackImagePositions[baseIdx + 1] + (Math.random() - 0.5) * 1.2;
                    positions[i * 3 + 2] = callbackImagePositions[baseIdx + 2] + (Math.random() - 0.5) * 6;
                }
                return positions;
            }

            // Fallback: simple arc while icon loads
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                const angle = Math.random() * Math.PI * 1.2 + Math.PI * 0.2;
                const radius = 40 + Math.random() * 10;
                positions[i * 3] = Math.cos(angle) * radius;
                positions[i * 3 + 1] = Math.sin(angle) * radius;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 8;
            }
            return positions;
        }

        function generateCirclePositions() {
            const positions = new Float32Array(PARTICLE_COUNT * 3);
            const tableParticles = Math.floor(PARTICLE_COUNT * 0.45);
            const chairParticles = Math.floor(PARTICLE_COUNT * 0.40);
            
            let idx = 0;
            const tableX = -15;
            const tableTopY = 0;
            const tableWidth = 35;
            const tableThickness = 3;
            
            for (let i = 0; i < tableParticles && idx < PARTICLE_COUNT; i++) {
                const part = Math.random();
                
                if (part < 0.5) {
                    positions[idx * 3] = tableX + (Math.random() - 0.5) * tableWidth;
                    positions[idx * 3 + 1] = tableTopY + (Math.random() - 0.5) * tableThickness;
                    positions[idx * 3 + 2] = (Math.random() - 0.5) * 8;
                } else if (part < 0.75) {
                    const legX = tableX - tableWidth * 0.4;
                    positions[idx * 3] = legX + (Math.random() - 0.5) * 3;
                    positions[idx * 3 + 1] = -25 + Math.random() * 25;
                    positions[idx * 3 + 2] = (Math.random() - 0.5) * 3;
                } else {
                    const legX = tableX + tableWidth * 0.4;
                    positions[idx * 3] = legX + (Math.random() - 0.5) * 3;
                    positions[idx * 3 + 1] = -25 + Math.random() * 25;
                    positions[idx * 3 + 2] = (Math.random() - 0.5) * 3;
                }
                idx++;
            }
            
            const chairX = 25;
            const seatY = -8;
            const seatWidth = 14;
            const seatDepth = 4;
            const backHeight = 25;
            
            for (let i = 0; i < chairParticles && idx < PARTICLE_COUNT; i++) {
                const part = Math.random();
                
                if (part < 0.3) {
                    positions[idx * 3] = chairX + (Math.random() - 0.5) * seatWidth;
                    positions[idx * 3 + 1] = seatY + (Math.random() - 0.5) * 2;
                    positions[idx * 3 + 2] = (Math.random() - 0.5) * seatDepth;
                } else if (part < 0.55) {
                    const backX = chairX + seatWidth * 0.4;
                    positions[idx * 3] = backX + (Math.random() - 0.5) * 3;
                    positions[idx * 3 + 1] = seatY + Math.random() * backHeight;
                    positions[idx * 3 + 2] = (Math.random() - 0.5) * seatDepth;
                } else if (part < 0.7) {
                    const legX = chairX - seatWidth * 0.35;
                    positions[idx * 3] = legX + (Math.random() - 0.5) * 2;
                    positions[idx * 3 + 1] = -25 + Math.random() * 17;
                    positions[idx * 3 + 2] = (Math.random() - 0.5) * 2;
                } else if (part < 0.85) {
                    const legX = chairX + seatWidth * 0.35;
                    positions[idx * 3] = legX + (Math.random() - 0.5) * 2;
                    positions[idx * 3 + 1] = -25 + Math.random() * 17;
                    positions[idx * 3 + 2] = (Math.random() - 0.5) * 2;
                } else {
                    const backX = chairX + seatWidth * 0.4;
                    const topY = seatY + backHeight;
                    positions[idx * 3] = backX + (Math.random() - 0.5) * 4;
                    positions[idx * 3 + 1] = topY + (Math.random() - 0.5) * 3;
                    positions[idx * 3 + 2] = (Math.random() - 0.5) * seatDepth;
                }
                idx++;
            }
            
            for (; idx < PARTICLE_COUNT; idx++) {
                const t = Math.random();
                if (t < 0.6) {
                    positions[idx * 3] = (Math.random() - 0.5) * 120;
                    positions[idx * 3 + 1] = -25 + (Math.random() - 0.5) * 2;
                    positions[idx * 3 + 2] = (Math.random() - 0.5) * 15;
                } else {
                    positions[idx * 3] = (Math.random() - 0.5) * 100;
                    positions[idx * 3 + 1] = (Math.random() - 0.5) * 60;
                    positions[idx * 3 + 2] = -15 + Math.random() * 10;
                }
            }

            return positions;
        }

        function generateFilmPositions() {
            const positions = new Float32Array(PARTICLE_COUNT * 3);
            
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                const t = Math.random();
                
                if (t < 0.4) {
                    const angle = Math.random() * Math.PI * 2;
                    const r = 22 + (Math.random() - 0.5) * 6;
                    
                    positions[i * 3] = Math.cos(angle) * r;
                    positions[i * 3 + 1] = Math.sin(angle) * r;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 3;
                } else if (t < 0.55) {
                    const holeNum = Math.floor(Math.random() * 8);
                    const holeAngle = (holeNum / 8) * Math.PI * 2;
                    const holeR = 12;
                    
                    const localAngle = Math.random() * Math.PI * 2;
                    const localR = 2 + Math.random() * 2;
                    
                    positions[i * 3] = Math.cos(holeAngle) * holeR + Math.cos(localAngle) * localR;
                    positions[i * 3 + 1] = Math.sin(holeAngle) * holeR + Math.sin(localAngle) * localR;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 2;
                } else if (t < 0.7) {
                    const angle = Math.random() * Math.PI * 2;
                    const r = Math.random() * 5;
                    
                    positions[i * 3] = Math.cos(angle) * r;
                    positions[i * 3 + 1] = Math.sin(angle) * r;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 4;
                } else {
                    const stripPos = Math.random();
                    const wave = Math.sin(stripPos * Math.PI * 4) * 5;
                    
                    positions[i * 3] = 30 + stripPos * 40;
                    positions[i * 3 + 1] = wave + (Math.random() - 0.5) * 8;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 3;
                }
            }

            return positions;
        }

        function generatePhoenixPositions() {
            const positions = new Float32Array(PARTICLE_COUNT * 3);
            
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                const t = Math.random();
                
                if (t < 0.25) {
                    const bodyT = Math.random();
                    const bodyWidth = Math.sin(bodyT * Math.PI) * 8;
                    
                    positions[i * 3] = (Math.random() - 0.5) * bodyWidth;
                    positions[i * 3 + 1] = -20 + bodyT * 50;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 4;
                } else if (t < 0.5) {
                    const wingT = Math.random();
                    const side = Math.random() < 0.5 ? -1 : 1;
                    const wingSpread = 15 + wingT * 35;
                    const wingHeight = 10 - Math.pow(wingT, 1.5) * 25;
                    
                    positions[i * 3] = side * wingSpread + (Math.random() - 0.5) * 5;
                    positions[i * 3 + 1] = wingHeight + (Math.random() - 0.5) * 8;
                    positions[i * 3 + 2] = (Math.random() - 0.5) * 5;
                } else if (t < 0.7) {
                    const crownAngle = Math.random() * Math.PI * 2;
                    const crownR = Math.random() * 6;
                    
                    positions[i * 3] = Math.cos(crownAngle) * crownR;
                    positions[i * 3 + 1] = 28 + Math.random() * 10;
                    positions[i * 3 + 2] = Math.sin(crownAngle) * crownR * 0.3;
                } else {
                    const burstAngle = Math.random() * Math.PI * 2;
                    const burstR = 30 + Math.random() * 30;
                    const burstY = (Math.random() - 0.3) * 60;
                    
                    positions[i * 3] = Math.cos(burstAngle) * burstR;
                    positions[i * 3 + 1] = burstY;
                    positions[i * 3 + 2] = Math.sin(burstAngle) * burstR * 0.4;
                }
            }

            return positions;
        }

        function generateLogoPositions() {
            const positions = new Float32Array(PARTICLE_COUNT * 3);
            
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                const t = i / PARTICLE_COUNT;
                const spiralAngle = t * Math.PI * 8;
                const spiralRadius = (1 - t) * 50 + Math.random() * 10;
                
                positions[i * 3] = Math.cos(spiralAngle) * spiralRadius;
                positions[i * 3 + 1] = Math.sin(spiralAngle) * spiralRadius * 0.6 + (Math.random() - 0.5) * 10;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 20 - 20;
            }

            return positions;
        }

        // Load and process logo image for particle positions
        async function loadLogoImage() {
            return new Promise((resolve) => {
                const img = new Image();
                img.crossOrigin = 'anonymous';
                img.onload = () => {
                    // Create offscreen canvas to sample pixels
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    // Scale down for sampling (smaller = faster, fewer points)
                    const sampleSize = 150;
                    const aspectRatio = img.width / img.height;
                    canvas.width = sampleSize;
                    canvas.height = Math.floor(sampleSize / aspectRatio);
                    
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const pixels = imageData.data;
                    
                    // Extract non-transparent pixel positions
                    const validPositions = [];
                    for (let y = 0; y < canvas.height; y++) {
                        for (let x = 0; x < canvas.width; x++) {
                            const i = (y * canvas.width + x) * 4;
                            const alpha = pixels[i + 3];
                            // Only include pixels with significant opacity
                            if (alpha > 100) {
                                validPositions.push({
                                    x: (x / canvas.width - 0.5) * 100, // Scale to world coords
                                    y: -(y / canvas.height - 0.5) * 100 / aspectRatio // Flip Y
                                });
                            }
                        }
                    }
                    
                    // Generate positions for all particles
                    const positions = new Float32Array(PARTICLE_COUNT * 3);
                    for (let i = 0; i < PARTICLE_COUNT; i++) {
                        if (validPositions.length > 0) {
                            const pos = validPositions[Math.floor(Math.random() * validPositions.length)];
                            positions[i * 3] = pos.x + (Math.random() - 0.5) * 2;
                            positions[i * 3 + 1] = pos.y + (Math.random() - 0.5) * 2;
                            positions[i * 3 + 2] = (Math.random() - 0.5) * 10 - 20;
                        } else {
                            // Fallback if no valid positions
                            positions[i * 3] = (Math.random() - 0.5) * 100;
                            positions[i * 3 + 1] = (Math.random() - 0.5) * 100;
                            positions[i * 3 + 2] = (Math.random() - 0.5) * 20 - 20;
                        }
                    }
                    
                    logoImagePositions = positions;
                    resolve(positions);
                };
                img.onerror = () => {
                    console.warn('Failed to load logo image, using fallback');
                    resolve(generateLogoPositions());
                };
                img.src = '/static/images/omi-logo-transparent-graphic.png';
            });
        }

        // Load and process callback icon (incoming call SVG) for Step 2
        async function loadCallbackImage() {
            return new Promise((resolve) => {
                const img = new Image();
                img.crossOrigin = 'anonymous';
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');

                    const sampleSize = 180;
                    const aspectRatio = img.width / img.height;
                    canvas.width = sampleSize;
                    canvas.height = Math.floor(sampleSize / aspectRatio);

                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const pixels = imageData.data;

                    const validPositions = [];
                    for (let y = 0; y < canvas.height; y++) {
                        for (let x = 0; x < canvas.width; x++) {
                            const i = (y * canvas.width + x) * 4;
                            const alpha = pixels[i + 3];
                            if (alpha > 100) {
                                validPositions.push({
                                    x: (x / canvas.width - 0.5) * 110,
                                    y: -(y / canvas.height - 0.5) * 110 / aspectRatio
                                });
                            }
                        }
                    }

                    const positions = new Float32Array(PARTICLE_COUNT * 3);
                    for (let i = 0; i < PARTICLE_COUNT; i++) {
                        if (validPositions.length > 0) {
                            const pos = validPositions[Math.floor(Math.random() * validPositions.length)];
                            positions[i * 3] = pos.x + (Math.random() - 0.5) * 1.5;
                            positions[i * 3 + 1] = pos.y + (Math.random() - 0.5) * 1.5;
                            positions[i * 3 + 2] = (Math.random() - 0.5) * 8;
                        } else {
                            positions[i * 3] = (Math.random() - 0.5) * 100;
                            positions[i * 3 + 1] = (Math.random() - 0.5) * 100;
                            positions[i * 3 + 2] = (Math.random() - 0.5) * 20;
                        }
                    }

                    callbackImagePositions = positions;
                    resolve(positions);
                };
                img.onerror = () => {
                    console.warn('Failed to load callback icon image, using fallback');
                    resolve(null);
                };
                img.src = '/static/images/incoming-call-icon.svg';
            });
        }

        function generateImageLogoPositions() {
            if (logoImagePositions) {
                return logoImagePositions;
            }
            // Fallback if image not loaded yet
            return generateLogoPositions();
        }

        function setParticlePositions(stage) {
            switch(stage) {
                case 'trees':
                    targetPositions = generateTreePositions();
                    break;
                case 'scroll':
                    targetPositions = generateScrollPositions();
                    break;
                case 'spiral':
                    targetPositions = generateSpiralPositions();
                    break;
                case 'circle':
                    targetPositions = generateCirclePositions();
                    break;
                case 'film':
                    targetPositions = generateFilmPositions();
                    break;
                case 'phoenix':
                    targetPositions = generatePhoenixPositions();
                    break;
                case 'logo':
                    targetPositions = generateLogoPositions();
                    break;
                case 'imageLogo':
                    targetPositions = generateImageLogoPositions();
                    break;
            }
            currentStage = stage;
        }

        function updateStageText(stage, stepIndex = -1) {
            const textEl = document.getElementById('heroStageText');
            const introEl = document.getElementById('heroIntroText');
            const numberEl = document.getElementById('heroStepNumber');
            const titleEl = document.getElementById('heroStepTitle');
            const descEl = document.getElementById('heroStepDesc');

            if (stage === 'trees') {
                textEl.classList.remove('visible');
                introEl.classList.add('visible');
            } else if (stepIndex >= 0 && stepIndex < STORYTELLING_STEPS.length) {
                introEl.classList.remove('visible');
                const step = STORYTELLING_STEPS[stepIndex];
                numberEl.textContent = step.number;
                titleEl.textContent = step.title;
                descEl.textContent = step.desc;
                textEl.classList.add('visible');
            } else {
                textEl.classList.remove('visible');
                introEl.classList.remove('visible');
            }
        }

        function startExperience() {
            currentStage = 'trees';
            stageStartTime = Date.now();
            updateStageText('trees');

            const shapes = ['scroll', 'spiral', 'circle', 'film', 'imageLogo'];
            // Trees stage lasts 3 seconds longer (STAGE_DURATION + 3000)
            let delay = STAGE_DURATION + 3000;

            shapes.forEach((shape, index) => {
                setTimeout(() => {
                    setParticlePositions(shape);
                    updateStageText(shape, index);
                    stageStartTime = Date.now();
                }, delay);
                delay += STAGE_DURATION;
            });

            // After all steps (including logo), reset to trees
            setTimeout(() => {
                const alphas = particles.geometry.attributes.alpha.array;
                for (let i = 0; i < PARTICLE_COUNT; i++) {
                    alphas[i] = 0;
                }
                particles.geometry.attributes.alpha.needsUpdate = true;
                
                setParticlePositions('trees');
                
                setTimeout(() => startExperience(), 1000);
            }, delay + 3000);
        }

        function animate() {
            requestAnimationFrame(animate);
            time += 0.016;

            if (particles) {
                const positions = particles.geometry.attributes.position.array;
                const alphas = particles.geometry.attributes.alpha.array;

                const lerpSpeed = 0.025;
                for (let i = 0; i < PARTICLE_COUNT * 3; i++) {
                    positions[i] += (targetPositions[i] - positions[i]) * lerpSpeed;
                }

                for (let i = 0; i < PARTICLE_COUNT; i++) {
                    const idx = i * 3;
                    positions[idx + 1] += Math.sin(time * 1.5 + i * 0.03) * 0.015;
                }

                const targetAlpha = currentStage === 'logo' ? 0.4 : 0.85;
                for (let i = 0; i < PARTICLE_COUNT; i++) {
                    alphas[i] += (targetAlpha - alphas[i]) * 0.02;
                }

                particles.geometry.attributes.position.needsUpdate = true;
                particles.geometry.attributes.alpha.needsUpdate = true;
                particles.material.uniforms.time.value = time;

                if (currentStage === 'spiral') {
                    particles.rotation.y += 0.003;
                } else if (currentStage === 'film') {
                    particles.rotation.z += 0.002;
                } else if (currentStage === 'phoenix') {
                    particles.rotation.y += 0.001;
                } else if (currentStage === 'logo') {
                    particles.rotation.y += 0.004;
                } else {
                    particles.rotation.y *= 0.98;
                    particles.rotation.z *= 0.98;
                }
            }

            renderer.render(scene, camera);
        }

        function onWindowResize() {
            const container = document.getElementById('hero-canvas-container');
            if (!container || !renderer) return;
            
            // Right-aligned: use 60% of viewport width
            const canvasWidth = Math.floor(window.innerWidth * 0.6);
            const canvasHeight = window.innerHeight;
            
            camera.aspect = canvasWidth / canvasHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(canvasWidth, canvasHeight);
            
            if (particles) {
                particles.material.uniforms.pixelRatio.value = Math.min(window.devicePixelRatio, 2);
            }
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initHeroAnimation);
        } else {
            initHeroAnimation();
        }
    </script>
    
    <!-- JavaScript for Contact Panel -->
    <script>
        function openContactPanel() {
            document.getElementById('contactPanel').classList.add('open');
            document.getElementById('contactOverlay').classList.add('open');
            document.body.style.overflow = 'hidden';
        }
        
        function closeContactPanel() {
            document.getElementById('contactPanel').classList.remove('open');
            document.getElementById('contactOverlay').classList.remove('open');
            document.body.style.overflow = '';
        }
        
        // Close panel with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeContactPanel();
            }
        });
        
        // Handle form submission
        document.getElementById('projectForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            
            try {
                const response = await fetch('/api/v1/contact', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                });
                
                if (response.ok) {
                    alert('Thank you! Your project has been submitted successfully.');
                    this.reset();
                    closeContactPanel();
                } else {
                    alert('Something went wrong. Please try again.');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Something went wrong. Please try again.');
            }
        });
    </script>
</body>
</html>
